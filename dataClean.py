import pandas as pd

# 导入Excel文件
input_file = 'input.xlsx'
output_file = 'output.xlsx'

# 读取导入数据
df_input = pd.read_excel(input_file)

# 创建空的输出数据框架
df_output = pd.DataFrame(columns=['客户名称（必填）', '国家/地区（必填）', '姓名（必填）','邮箱(必填)','客户简称','固定电话','客户网站','传真(客户)','联系地址','备注','性别','生日','传真(联系人)',
'职位','电话','联系人备注','社交账号','客户来源','客户状态','客户类型','标签'])  # 根据导出模板的列名填写

# 对应导入数据到导出列
df_output['邮箱(必填)'] = df_input['邮箱(Email)']
df_output['国家/地区（必填）'] = df_input['买家国家(Buyer Country)']

for index, row in df_input.iterrows():
    if pd.isnull(row['公司名称(Company Name)']):
        df_output['客户名称（必填）'] =df_input['买家名称(Buyer Name)']
    else:
        df_output['客户名称（必填）'] = df_input['公司名称(Company Name)']


for index, row in df_input.iterrows():
    if pd.isnull(row['买家名称(Buyer Name)']):
        df_output['姓名（必填）'] = df_input['公司名称(Company Name)']
    else:
        df_output['姓名（必填）'] = df_input['买家名称(Buyer Name)']

df_output['固定电话'] = df_input['固定电话']
df_output['传真(客户)'] = df_input['公司名称(Company Name)']
df_output['联系地址'] = df_input['收货地址']
df_output['传真(联系人)'] = df_input['收货人']
df_output['电话'] = df_input['固定电话']

for index, row in df_input.iterrows():
    if pd.isnull(row['实际发货时间(Actual Delivery Time)']):
        df_output.loc[index, '客户状态'] = '未成交'
    else:
        df_output.loc[index, '客户状态'] = '已成交'

for index, row in df_input.iterrows():
    if pd.isnull(row['实际发货时间(Actual Delivery Time)']):
        df_output.loc[index, '标签'] = ' '
    else:
        df_output.loc[index, '标签'] = '历史成交'



# 导出数据到Excel
df_output.to_excel(output_file, index=False)


